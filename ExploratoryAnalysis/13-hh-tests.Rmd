# Water point chlorine residual tests

```{r}
library(stringr)
library(sf)
library(tidyverse)
library(modelsummary)
library(fixest)
library(janitor)
```

## Prepare data

```{r}
hh_test <-
  read_rds(
    file.path(
      path_box,
      "Data",
      "HouseholdSurvey",
      "DataSets",
      "Constructed",
      "hh-survey-chlorine.rds"
    )
  ) 

hh_constructed <-
  read_rds(
    file.path(
      path_box,
      "Data",
      "HouseholdSurvey",
      "DataSets",
      "Constructed",
      "hh-survey-constructed.rds"
    )
  ) 

hh <-
  hh_final %>%
  select(
    key, survey,
    household_id, country, village_id, district_id, wp_id,
    wp_intervention, wp_intervention_type, wp_func, wp_sourcetype,
    ilc, dsw, ilc_wp, ilc_wcp, 
    wp_dsw_dose, wp_dsw_chlorine, 
    watertreat_any, watertreat_boil, watertreat_dispcl, watertreat_othercl,
    howlong_waterprep, where_collect, who_collected, 
    int_warned, int_promoter,
    storage, access_contain, cover_storage,
    hhh_age, hhh_sex, hhh_educ, age_child,
    hh_pregnant, hh_under5, hh_under2,
    wp_turbidity, wp_pay,
    hh_dsw, hh_ilc,
    contains("flag"), contains("photo"), contains("pic")
  ) %>%
  left_join(
    hh_test, .,
    relationship = "many-to-one"
  ) 

test_long <-
  hh %>%
  pivot_longer(
    cols = c(matches("(*.)cr_c$"), matches("(*.)cr_color$")),
    names_pattern = "(.*)(...)_(.*)",
    names_to = c("instrument", "test", ".value")
  ) %>%
  rename(
    value = c
  ) %>%
  mutate(
    instrument = case_when(
      instrument == "meter" ~ "Colorimeter",
      instrument == "disc" ~ "Color wheel"
    ),
    test = test %>% str_to_upper,
    sourcetype = 
      case_when(
        wp_sourcetype == "River, stream, or other flowing water source" ~ "Flowing water source",
        wp_sourcetype ==  "Lake, pond, dam, or other standing water source" ~ "Standing water source",
        TRUE ~ wp_sourcetype %>% 
          str_replace_all("not powered by solar/electricity", "(not powered)") %>%
          str_replace_all("powered by solar/electricity", "(powered)")
      )
  )
```

## Number of observations

```{r}
hh %>%
  group_by(country, survey) %>%
  summarise(
    across(
      c(household_id, wp_id, village_id),
      ~ n_distinct(.)
    ),
    across(
      c(disctcr_c, discfcr_c, metertcr_c, meterfcr_c),
      ~ sum(!is.na(.))
    )
  ) %>%
  ungroup %>%
  select(-country) %>%
  kable(
    format = "html",
    col.names = c(
      "Survey",
      "Households", "Water points", "Villages",
      "TCR", "FCR", "TCR", "FCR"
    )
  ) %>%
  pack_rows("Malawi", 1, 2) %>%
  pack_rows("Uganda", 3, 4) %>%
  pack_rows("Unmatched", 5, 5) %>%
  add_header_above(c(" " = 4, "Color wheel" = 2, "Colorimeter" = 2)) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = TRUE,
    font_size = 14
  )
```

## Descriptives

### Distribution of readings

The maximum value in the color disc is 3.5, and in the colorimeter it's 2.2. When readings exceed 2.2, the colorimeter threw an error. These observations are replaced with 2.4.

```{r}
test_long %>%
  ggplot(
    aes(
      y = after_stat(density),
      x = value,
      fill = country
    )
  ) +
  geom_histogram(
    position = "identity",
    alpha = .5
  ) +
  facet_grid(test ~ instrument) +
  theme
```

### TCR and FCR readings

```{r}
test_long %>%
  pivot_wider(
    names_from = test,
    values_from = value
  ) %>% 
  ggplot(
    aes(
      x = FCR,
      y = TCR,
      color = country
    )
  ) +
  geom_abline(
    slope = 1,
    color = "gray80"
  ) +
  geom_abline(
    slope = 1,
    intercept = -0.1,
    color = "gray80",
    linetype = "dashed"
  ) +
  geom_abline(
    slope = 1,
    intercept = -0.2,
    color = "gray80",
    linetype = "dotted"
  ) +
  geom_abline(
    slope = 1,
    color = "gray80"
  ) +
  geom_point(
    position = "jitter",
    alpha = .5
  ) +
  theme +
  facet_wrap(~ instrument, scales = "free") +
  scale_color_viridis_d()
```

### Dosage and chlorine residual

```{r}
test_long %>%
  ggplot(
    aes(
      y = wp_dsw_dose,
      x = value,
      fill = country
    )
  ) +
  geom_boxplot(alpha = .5)  +
  theme +
  facet_grid(test ~ instrument, scales = "free") +
  scale_fill_viridis_d()
```

### Reported color and chlorine residual

```{r}
test_long %>%
  ggplot(
    aes(
      y = color,
      x = value,
      fill = country
    )
  ) +
  geom_boxplot(alpha = .5)  +
  theme +
  facet_grid(test ~ instrument, scales = "free") +
  scale_fill_viridis_d()
```

### Reported source type and chlorine residual

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(sourcetype)) %>%
  group_by(country, instrument, sourcetype, test) %>%
  summarise(value = sum(!is.na(value))) %>%
  dplyr::filter(test == "TCR") %>%
  pivot_wider(
    values_from = value,
    names_from = instrument
  ) %>%
  ungroup %>%
  arrange(desc(`Color wheel`)) %>%
  pivot_wider(
    values_from = c(`Color wheel`, Colorimeter),
    names_from = country
  ) %>%
  select(
    sourcetype, 
    ends_with("Malawi"),
    ends_with("Uganda")
  ) %>%
  kable(
    format = "html",
    col.names = c("Source type", "Color wheel", "Colorimeter", "Color wheel", "Colorimeter")
  ) %>%
  add_header_above(c(" " = 1, "Malawi" = 2, "Uganda" = 2)) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = TRUE,
    font_size = 14
  )
```

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(sourcetype)) %>%
  group_by(country, sourcetype, instrument, test) %>%
  dplyr::filter(n() > 50) %>%
  ungroup %>%
  ggplot(
    aes(
      y = sourcetype,
      x = value,
      fill = country
    )
  ) +
  geom_boxplot(alpha = .5)  +
  theme +
  facet_grid(test ~ instrument, scales = "free") +
  scale_fill_viridis_d()
```

### Turbity and chlorine residual

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(wp_turbidity)) %>%
  group_by(country, instrument, wp_turbidity, test) %>%
  summarise(value = sum(!is.na(value))) %>%
  dplyr::filter(test == "TCR") %>%
  pivot_wider(
    values_from = value,
    names_from = instrument
  ) %>%
  ungroup %>%
  arrange(desc(`Color wheel`)) %>%
  pivot_wider(
    values_from = c(`Color wheel`, Colorimeter),
    names_from = country
  ) %>%
  select(
    wp_turbidity, 
    ends_with("Malawi"),
    ends_with("Uganda")
  ) %>%
  kable(
    format = "html",
    col.names = c("Turbidity", "Color wheel", "Colorimeter", "Color wheel", "Colorimeter")
  ) %>%
  add_header_above(c(" " = 1, "Malawi" = 2, "Uganda" = 2)) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = TRUE,
    font_size = 14
  )
```

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(wp_turbidity)) %>%
  group_by(country, wp_turbidity, instrument, test) %>%
  dplyr::filter(n() > 50) %>%
  ungroup %>%
  ggplot(
    aes(
      y = wp_turbidity,
      x = value,
      fill = country
    )
  ) +
  geom_boxplot(alpha = .5)  +
  theme +
  facet_grid(test ~ instrument, scales = "free") +
  scale_fill_viridis_d()
```

### Time since chlorination

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(howlong_waterprep)) %>%
  group_by(country, instrument, howlong_waterprep, test) %>%
  summarise(value = sum(!is.na(value))) %>%
  dplyr::filter(test == "TCR") %>%
  pivot_wider(
    values_from = value,
    names_from = instrument
  ) %>%
  ungroup %>%
  arrange(desc(`Color wheel`)) %>%
  pivot_wider(
    values_from = c(`Color wheel`, Colorimeter),
    names_from = country
  ) %>%
  select(
    howlong_waterprep, 
    ends_with("Malawi"),
    ends_with("Uganda")
  ) %>%
  kable(
    format = "html",
    col.names = c("Source type", "Color wheel", "Colorimeter", "Color wheel", "Colorimeter")
  ) %>%
  add_header_above(c(" " = 1, "Malawi" = 2, "Uganda" = 2)) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = TRUE,
    font_size = 14
  )
```

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(howlong_waterprep)) %>%
  group_by(country, howlong_waterprep, instrument, test) %>%
  dplyr::filter(sum(!is.na(value)) > 40) %>%
  ungroup %>%
  ggplot(
    aes(
      y = howlong_waterprep,
      x = value,
      fill = country
    )
  ) +
  geom_boxplot(alpha = .5)  +
  theme +
  facet_grid(test ~ instrument, scales = "free") +
  scale_fill_viridis_d()
```

### Source of tested water

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(where_collect)) %>%
  group_by(country, instrument, where_collect, test) %>%
  summarise(value = sum(!is.na(value))) %>%
  dplyr::filter(test == "TCR") %>%
  pivot_wider(
    values_from = value,
    names_from = instrument
  ) %>%
  ungroup %>%
  arrange(desc(`Color wheel`)) %>%
  pivot_wider(
    values_from = c(`Color wheel`, Colorimeter),
    names_from = country
  ) %>%
  select(
    where_collect, 
    ends_with("Malawi"),
    ends_with("Uganda")
  ) %>%
  kable(
    format = "html",
    col.names = c("Source type", "Color wheel", "Colorimeter", "Color wheel", "Colorimeter")
  ) %>%
  add_header_above(c(" " = 1, "Malawi" = 2, "Uganda" = 2)) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = TRUE,
    font_size = 14
  )
```

### Storage

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(storage)) %>%
  group_by(country, instrument, storage, test) %>%
  summarise(value = sum(!is.na(value))) %>%
  dplyr::filter(test == "TCR") %>%
  pivot_wider(
    values_from = value,
    names_from = instrument
  ) %>%
  ungroup %>%
  arrange(desc(`Color wheel`)) %>%
  pivot_wider(
    values_from = c(`Color wheel`, Colorimeter),
    names_from = country
  ) %>%
  select(
    storage, 
    ends_with("Malawi"),
    ends_with("Uganda")
  ) %>%
  kable(
    format = "html",
    col.names = c("Source type", "Color wheel", "Colorimeter", "Color wheel", "Colorimeter")
  ) %>%
  add_header_above(c(" " = 1, "Malawi" = 2, "Uganda" = 2)) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = TRUE,
    font_size = 14
  )
```

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(storage)) %>%
  group_by(country, storage, instrument, test) %>%
  dplyr::filter(sum(!is.na(value)) > 30) %>%
  ungroup %>%
  ggplot(
    aes(
      y = storage,
      x = value,
      fill = country
    )
  ) +
  geom_boxplot(alpha = .5)  +
  theme +
  facet_grid(test ~ instrument, scales = "free") +
  scale_fill_viridis_d()
```

### Water fetched by children

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(who_collected)) %>%
  group_by(country, instrument, who_collected, test) %>%
  summarise(value = sum(!is.na(value))) %>%
  dplyr::filter(test == "TCR") %>%
  pivot_wider(
    values_from = value,
    names_from = instrument
  ) %>%
  ungroup %>%
  arrange(desc(`Color wheel`)) %>%
  pivot_wider(
    values_from = c(`Color wheel`, Colorimeter),
    names_from = country
  ) %>%
  select(
    who_collected, 
    ends_with("Malawi"),
    ends_with("Uganda")
  ) %>%
  kable(
    format = "html",
    col.names = c("Source type", "Color wheel", "Colorimeter", "Color wheel", "Colorimeter")
  ) %>%
  add_header_above(c(" " = 1, "Malawi" = 2, "Uganda" = 2)) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = TRUE,
    font_size = 14
  )
```

```{r}
test_long %>%
  dplyr::filter(!is.na(country), !is.na(who_collected)) %>%
  group_by(country, who_collected, instrument, test) %>%
  ungroup %>%
  ggplot(
    aes(
      y = who_collected,
      x = value,
      fill = country
    )
  ) +
  geom_boxplot(alpha = .5)  +
  theme +
  facet_grid(test ~ instrument, scales = "free") +
  scale_fill_viridis_d()
```


## Test wait time and chlorine residual


```{r}
hh %>%
  select(household_id, matches("(.)cr_c$"), matches("(.)cr_color$")) %>%
  pivot_longer(
    cols = -household_id,
    names_pattern = "(.*)(...)_(.*)",
    names_to = c("instrument", "test", ".value"),
    values_drop_na  = TRUE
  ) %>%
  group_by(instrument, test) %>%
  group_split %>%
  map(
    ~ lm(
      c ~ color,
      data = .x
    )
  ) %>%
  set_names(
    c(
      "Color wheel TCR", "Color wheel FCR",
      "Colorimeter TCR", "Colorimeter FCR"
    )
  ) %>%
  modelsummary(
    stars = TRUE,
    gof_omit = "IC|Log|RMSE|R2$"
  )
```


```{r}
hh %>%
  select(household_id, matches("(.)cr_c$"), matches("(.)cr_color$")) %>%
  pivot_longer(
    cols = -household_id,
    names_pattern = "(.*)(...)_(.*)",
    names_to = c("instrument", "test", ".value"),
    values_drop_na  = TRUE
  ) %>%
  dplyr::filter(!is.na(color)) %>%
  ggplot(
    aes(
      x = color,
      y = c
    )
  ) +
  geom_boxplot() +
  facet_grid(instrument ~ test, scales = "free_y")
```

```{r}
hh %>%
  select(household_id, matches("(.)cr_c$"), wp_turbidity) %>%
  pivot_longer(
    cols = -c(household_id, wp_turbidity),
    names_pattern = "(.*)(...)_c",
    names_to = c("instrument", "test"),
    values_drop_na  = TRUE
  ) %>%
  dplyr::filter(!is.na(wp_turbidity)) %>%
  ggplot(
    aes(
      y = wp_turbidity,
      x = value
    )
  ) +
  geom_boxplot() +
  xlim(0, 3) +
  facet_grid(instrument ~ test)
```

```{r}
hh %>%
  select(key, matches("(.)cr_c$"), wp_turbidity) %>%
  pivot_longer(
    cols = -c(key, wp_turbidity),
    names_pattern = "(.*)(...)_c",
    names_to = c("instrument", "test"),
    values_drop_na  = TRUE
  ) %>%
  dplyr::filter(!is.na(wp_turbidity)) %>%
  pivot_wider(
    id_cols = c(key, wp_turbidity, instrument),
    names_from = test,
    values_from = value
  ) %>%
  mutate(diff = tcr-fcr) %>%
  ggplot(
    aes(
      y = wp_turbidity,
      x = diff
    )
  ) +
  facet_wrap(~ instrument) +
  geom_boxplot()
```

## Fixed effect

### Enumerator

#### Color wheel

##### Uganda

```{r}
hh %>% 
  dplyr::filter(country == "Uganda") %>%
  select(household_id, enumerator_id, disctcr_c, discfcr_c, village_id) %>%
  pivot_longer(
    cols = c(disctcr_c, discfcr_c),
    names_pattern = "disc(...)_c",
    names_to = "test"
  ) %>%
  group_by(test) %>%
  group_split %>%
  map(
    ~ feols(
        value ~ enumerator_id | village_id,
        data = .x
      ) %>%
      broom::tidy(
        conf.int = TRUE
      ) %>%
      mutate(test = .x %>% pull(test) %>% unique %>% str_to_upper)
  ) %>%
  bind_rows %>%
  mutate(
    term = term %>% str_remove_all("enumerator_id")
  ) %>%
  ggplot(
    aes(
      y = term,
      x = estimate,
      xmin = conf.low,
      xmax = conf.high
    )
  ) +
  geom_errorbar() +
  geom_point() +
  geom_vline(xintercept = 0, linetype = "dashed") +
  facet_wrap(~ test)
```

##### Malawi

```{r}
hh %>% 
  dplyr::filter(country == "Malawi") %>%
  select(household_id, enumerator_id, disctcr_c, discfcr_c) %>%
  pivot_longer(
    cols = c(disctcr_c, discfcr_c),
    names_pattern = "disc(...)_c",
    names_to = "test"
  ) %>%
  group_by(test) %>%
  group_split %>%
  map(
    ~ feols(
        value ~ 0 +enumerator_id,
        data = .x
      ) %>%
      broom::tidy(
        conf.int = TRUE
      ) %>%
      mutate(test = .x %>% pull(test) %>% unique %>% str_to_upper)
  ) %>%
  bind_rows %>%
  mutate(
    term = term %>% str_remove_all("enumerator_id")
  ) %>%
  ggplot(
    aes(
      y = term,
      x = estimate,
      xmin = conf.low,
      xmax = conf.high
    )
  ) +
  geom_errorbar() +
  geom_point() +
  geom_vline(xintercept = 0, linetype = "dashed") +
  facet_wrap(~ test)
```
#### Colorimeter

##### Uganda

```{r}
hh %>% 
  dplyr::filter(country == "Uganda") %>%
  select(household_id, enumerator_id, metertcr_c, meterfcr_c) %>%
  pivot_longer(
    cols = c(metertcr_c, meterfcr_c),
    names_pattern = "meter(...)_c",
    names_to = "test"
  ) %>%
  group_by(test) %>%
  group_split %>%
  map(
    ~ feols(
        value ~ 0 +enumerator_id,
        data = .x
      ) %>%
      broom::tidy(
        conf.int = TRUE
      ) %>%
      mutate(test = .x %>% pull(test) %>% unique %>% str_to_upper)
  ) %>%
  bind_rows %>%
  mutate(
    term = term %>% str_remove_all("enumerator_id")
  ) %>%
  ggplot(
    aes(
      y = term,
      x = estimate,
      xmin = conf.low,
      xmax = conf.high
    )
  ) +
  geom_errorbar() +
  geom_point() +
  geom_vline(xintercept = 0, linetype = "dashed") +
  facet_wrap(~ test)
```

##### Malawi

```{r}
hh %>% 
  dplyr::filter(country == "Malawi") %>%
  select(household_id, enumerator_id, metertcr_c, meterfcr_c) %>%
  pivot_longer(
    cols = c(metertcr_c, meterfcr_c),
    names_pattern = "meter(...)_c",
    names_to = "test"
  ) %>%
  group_by(test) %>%
  group_split %>%
  map(
    ~ feols(
        value ~ 0 +enumerator_id,
        data = .x
      ) %>%
      broom::tidy(
        conf.int = TRUE
      ) %>%
      mutate(test = .x %>% pull(test) %>% unique %>% str_to_upper)
  ) %>%
  bind_rows %>%
  mutate(
    term = term %>% str_remove_all("enumerator_id")
  ) %>%
  ggplot(
    aes(
      y = term,
      x = estimate,
      xmin = conf.low,
      xmax = conf.high
    )
  ) +
  geom_errorbar() +
  geom_point() +
  geom_vline(xintercept = 0, linetype = "dashed") +
  facet_wrap(~ test)
```

### Color wheel ID

##### Uganda

```{r}
hh %>% 
  dplyr::filter(country == "Uganda") %>%
  select(household_id, discid, disctcr_c, discfcr_c, village_id) %>%
  mutate(discid = factor(discid)) %>%
  pivot_longer(
    cols = c(disctcr_c, discfcr_c),
    names_pattern = "disc(...)_c",
    names_to = "test"
  ) %>%
  group_by(test) %>%
  group_split %>%
  map(
    ~ feols(
        value ~ 0 + discid,
        data = .x
      ) %>%
      broom::tidy(
        conf.int = TRUE
      ) %>%
      mutate(test = .x %>% pull(test) %>% unique %>% str_to_upper)
  ) %>%
  bind_rows %>%
  mutate(
    term = term %>% str_remove_all("discid")
  ) %>%
  ggplot(
    aes(
      y = term,
      x = estimate,
      xmin = conf.low,
      xmax = conf.high
    )
  ) +
  geom_errorbar() +
  geom_point() +
  geom_vline(xintercept = 0, linetype = "dashed") +
  facet_wrap(~ test)
```

##### Malawi

```{r}
hh %>% 
  dplyr::filter(country == "Malawi") %>%
  mutate(discid = factor(discid)) %>%
  select(household_id, discid, disctcr_c, discfcr_c) %>%
  pivot_longer(
    cols = c(disctcr_c, discfcr_c),
    names_pattern = "disc(...)_c",
    names_to = "test"
  ) %>%
  group_by(test) %>%
  group_split %>%
  map(
    ~ feols(
        value ~ 0 + discid,
        data = .x
      ) %>%
      broom::tidy(
        conf.int = TRUE
      ) %>%
      mutate(test = .x %>% pull(test) %>% unique %>% str_to_upper)
  ) %>%
  bind_rows %>%
  mutate(
    term = term %>% str_remove_all("enumerator_id")
  ) %>%
  ggplot(
    aes(
      y = term,
      x = estimate,
      xmin = conf.low,
      xmax = conf.high
    )
  ) +
  geom_errorbar() +
  geom_point() +
  geom_vline(xintercept = 0, linetype = "dashed") +
  facet_wrap(~ test)
```

### Colorimeter ID

##### Uganda

```{r}
hh %>% 
  dplyr::filter(country == "Uganda") %>%
  select(household_id, meterid, metertcr_c, meterfcr_c, village_id) %>%
  mutate(meterid = factor(meterid)) %>%
  pivot_longer(
    cols = c(metertcr_c, meterfcr_c),
    names_pattern = "disc(...)_c",
    names_to = "test"
  ) %>%
  group_by(test) %>%
  group_split %>%
  map(
    ~ feols(
        value ~ 0 + meterid,
        data = .x
      ) %>%
      broom::tidy(
        conf.int = TRUE
      ) %>%
      mutate(test = .x %>% pull(test) %>% unique %>% str_to_upper)
  ) %>%
  bind_rows %>%
  mutate(
    term = term %>% str_remove_all("meterid")
  ) %>%
  ggplot(
    aes(
      y = term,
      x = estimate,
      xmin = conf.low,
      xmax = conf.high
    )
  ) +
  geom_errorbar() +
  geom_point() +
  geom_vline(xintercept = 0, linetype = "dashed") +
  facet_wrap(~ test)
```

##### Malawi

```{r}
hh %>% 
  dplyr::filter(country == "Malawi") %>%
  select(household_id, meterid, metertcr_c, meterfcr_c, village_id) %>%
  mutate(meterid = factor(meterid)) %>%
  pivot_longer(
    cols = c(metertcr_c, meterfcr_c),
    names_pattern = "disc(...)_c",
    names_to = "test"
  ) %>%
  group_by(test) %>%
  group_split %>%
  map(
    ~ feols(
        value ~ 0 + meterid,
        data = .x
      ) %>%
      broom::tidy(
        conf.int = TRUE
      ) %>%
      mutate(test = .x %>% pull(test) %>% unique %>% str_to_upper)
  ) %>%
  bind_rows %>%
  mutate(
    term = term %>% str_remove_all("meterid")
  ) %>%
  ggplot(
    aes(
      y = term,
      x = estimate,
      xmin = conf.low,
      xmax = conf.high
    )
  ) +
  geom_errorbar() +
  geom_point() +
  geom_vline(xintercept = 0.05, linetype = "dashed") +
  facet_wrap(~ test)
```

